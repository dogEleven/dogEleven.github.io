# 项目框架介绍 (Project Framework Overview)

本项目是一个基于 WebGL (Three.js) 的 3D 星球探索游戏/演示。项目主要包含以下几个核心模块和文件夹结构。

## 1. 目录结构

## 1. 目录结构

*   **根目录** (`d:\GitProject\dogEleven.github.io\`)
    *   `planet.html/`: **当前核心开发目录**。
        *   `index.html`: **主程序文件**。包含了所有的游戏逻辑、渲染代码、AI系统和 HTML 结构。
    *   `.agent/`: AI 助手的工作流和配置文件。

## 2. 技术栈

*   **核心引擎**: [Three.js (r128)](https://threejs.org/)
*   **语言**: 原生 HTML5, CSS3, JavaScript (ES6+)。
*   **着色器**: GLSL (自定义星球地形、材质、植被和水体)。

## 3. 核心功能模块 (`planet.html/index.html`)

### A. 渲染与环境 (Rendering & Environment)
*   **场景**: 3D 星球场景，CSS 渐变深空背景。
*   **特效**:
    *   **粒子系统**: 通用爆炸/烟尘系统。支持跳跃扬尘 (Jump Dust - 慢速烟雾) 和 死亡特效 (Death Explosion - 向上飘散)。
    *   **迷雾**: 距离场迷雾，融合天空颜色。

### B. 程序化与地形 (Procedural Generation)
*   **地形**: 基于噪声 (Noise) 的顶点置换，生成山脉与平原。
*   **道路**: 程序化生成的环球道路，地形自动压平适配。
*   **植被**: 实例化渲染 (InstancedMesh) 的草地、树木、蘑菇、花朵。
    *   **资源再生**: 采集后的资源 (石头、蘑菇) 会每 60 秒自动刷新。

### C. 实体与 AI 系统 (Entities & AI)

#### 1. 玩家 (Player)
*   **控制**: 键盘 (WASD+空格) 或 移动端虚拟摇杆。'J' 键可作为调试作弊跳过当前关卡。
*   **物理**: 自定义球体引力物理，支持跳跃、水浮力。
*   **交互**: 
    *   拾取物品 (一次一件)。
    *   **智能存贮**: 靠近建筑 (宿舍或工坊) 时自动按需求存入物品。

#### 2. 跟随者 (Followers / NPCs)
*   **行为**: 
    *   自动采集附近资源，并跟随玩家。
    *   **智能物流**: 持有资源时，会自动寻找并前往最近的、需要该资源的建筑 (宿舍、武器工坊或防具工坊) 进行存入。
    *   **跳跃同步**: 当玩家跳跃时，所有跟随者同步跳跃。
    *   **装备系统**: 可从工坊领取 **弓箭** (远程攻击) 和 **帽子** (抵挡一次伤害)。
*   **重生**: 死亡后会在宝箱附近自动重生。

#### 3. 敌人 - 狼 (Wolves)
*   **行为**: 具有 Wander (游荡), Circle (环绕), Dash/Bite (冲刺撕咬) 等状态。
*   **战斗**: 
    *   攻击会瞄准玩家或跟随者。
    *   **帽子机制**: 佩戴帽子的单位可抵挡一次狼的撕咬攻击 (帽子破碎)。
    *   **弓箭机制**: 玩家和跟随者会自动射击范围内的狼。

#### 4. 建筑系统 (Buildings)
*   **宿舍 (Dormitory)**: 核心基地，升级可提升最大跟随者上限。外观随等级变化 (茅草屋 -> 棕色石屋 -> 灰蓝石堡)。
*   **工坊 (Workshops)**:
    *   **武器工坊**: 建造后提供弓箭。
    *   **防具工坊**: 建造后提供帽子。

### D. 摄像机系统
*   **智能跟随**: 相机平滑跟随玩家，自动调整高度和距离。

## 4. 游戏流程 (Game Progression)

游戏通过 **宿舍等级 (Chest Level)** 推进，每一级都有明确的建造/升级目标：

### **Level 1: 原始积累 (Initial Hut)**
*   **目标**: 收集 **10 树枝** + **10 蘑菇**。
*   **存入**: 直接存入中央宿舍。
*   **奖励**: 
    *   跟随者上限提升至 **10**。
    *   解锁 **石头屋 (Level 2)** 升级。

### **Level 2: 石器时代 (Stone House Upgrade)**
*   **目标**: 收集 **20 石头**。
*   **建筑外观**: 宿舍升级为 **棕色石屋**。
*   **奖励**: 
    *   跟随者上限提升至 **15**。
    *   **解锁工坊地基**: 宿舍左右两侧出现武器工坊和防具工坊的地基 (4根木棍)。

### **Level 3: 工坊建设 (Workshop Construction)**
*   **目标**: 
    *   **20 树枝** -> 存入 **武器工坊** (左侧)。
    *   **20 树枝** -> 存入 **防具工坊** (右侧)。
*   **机制**: 
    *   玩家和跟随者需分别前往对应的工坊地基处存入资源。
    *   跟随者会自动寻找最近的未完成工坊进行配送。
*   **奖励**: 
    *   跟随者上限提升至 **20**。
    *   **工坊建成**: 工坊变为完整建筑。
    *   **装备解锁**: 
        *   靠近武器工坊可自动装备 **弓箭**。
        *   靠近防具工坊可自动装备 **帽子**。

---
*文档更新时间: 2025-12-20*
