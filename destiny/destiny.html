<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quantum Destiny | 科学命理实验室</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <style>
        :root {
            --bg: #030303;
            --card-bg: #0a0a0a;
            --accent: #00f2ff;
            --accent-glow: rgba(0, 242, 255, 0.4);
            --secondary: #ff00c1;
            --text: #e0e0e0;
            --subtext: #666;
        }
        @font-face {
            font-family: 'Geist';
            src: url('https://cdn.jsdelivr.net/gh/fontsource/geist@latest/fonts/variable/geist-sans.woff2') format('woff2');
        }
        body {
            background-color: var(--bg);
            background-image: 
                radial-gradient(circle at 2px 2px, rgba(0, 242, 255, 0.03) 1px, transparent 0),
                linear-gradient(rgba(0, 242, 255, 0.01) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 242, 255, 0.01) 1px, transparent 1px);
            background-size: 40px 40px, 100px 100px, 100px 100px;
            color: var(--text);
            font-family: 'Geist', 'Inter', -apple-system, system-ui, sans-serif;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            overflow: hidden;
        }
        #app {
            width: 100%;
            max-width: 520px;
            padding: 20px;
            text-align: center;
            z-index: 10;
        }
        .container {
            background: rgba(10, 10, 10, 0.8);
            backdrop-filter: blur(40px) saturate(180%);
            padding: 45px;
            border-radius: 40px;
            box-shadow: 0 0 100px rgba(0, 0, 0, 0.8), 0 0 40px rgba(0, 242, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.05);
            position: relative;
            overflow: hidden;
            transition: all 0.6s cubic-bezier(0.16, 1, 0.3, 1);
        }
        .container:hover {
            border-color: rgba(0, 242, 255, 0.3);
            box-shadow: 0 0 120px rgba(0, 242, 255, 0.15);
            transform: translateY(-5px);
        }
        .container::before {
            content: "";
            position: absolute;
            top: 0; left: 0; right: 0; height: 1px;
            background: linear-gradient(90deg, transparent, var(--accent), transparent);
            opacity: 0.3;
        }
        h1 {
            font-size: 36px;
            margin-bottom: 5px;
            letter-spacing: -2px;
            background: linear-gradient(135deg, #fff, #888);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 900;
        }
        p.subtitle {
            color: var(--subtext);
            font-size: 11px;
            margin-bottom: 35px;
            font-weight: 600;
            letter-spacing: 4px;
            text-transform: uppercase;
        }
        .input-group {
            margin-bottom: 30px;
            text-align: left;
        }
        label {
            display: block;
            font-size: 10px;
            text-transform: uppercase;
            margin-bottom: 12px;
            color: var(--subtext);
            font-weight: 700;
            letter-spacing: 2px;
        }
        input {
            width: 100%;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            padding: 18px 24px;
            border-radius: 20px;
            color: white;
            font-size: 16px;
            box-sizing: border-box;
            transition: all 0.4s;
            font-family: inherit;
        }
        input:focus {
            outline: none;
            border-color: var(--accent);
            background: rgba(255, 255, 255, 0.05);
            box-shadow: 0 0 30px rgba(0, 242, 255, 0.1);
        }
        button {
            width: 100%;
            padding: 20px;
            background: #fff;
            color: #000;
            border: none;
            border-radius: 20px;
            font-size: 15px;
            font-weight: 900;
            cursor: pointer;
            transition: all 0.4s;
            margin-top: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        button:hover {
            transform: scale(1.02);
            background: var(--accent);
            box-shadow: 0 0 40px rgba(0, 242, 255, 0.4);
        }
        button:active { transform: scale(0.98); }
        button:disabled { opacity: 0.3; cursor: not-allowed; }

        .result {
            margin-top: 45px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 30px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            animation: slideUp 0.8s cubic-bezier(0.16, 1, 0.3, 1);
        }
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fortune-text {
            font-size: 16px;
            line-height: 1.8;
            color: #bbb;
            text-align: left;
            margin-bottom: 25px;
        }
        .theory-tag {
            display: inline-block;
            padding: 4px 12px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            font-size: 10px;
            font-weight: 700;
            color: var(--accent);
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Module Specific Visuals */
        .viz-box {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 20px;
            padding: 20px;
            margin-top: 20px;
            border: 1px solid rgba(255, 255, 255, 0.03);
            position: relative;
        }
        
        /* Genetic Algorithm Visual */
        .gene-pool {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .gene-strand {
            height: 4px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 2px;
            overflow: hidden;
            display: flex;
        }
        .gene-segment {
            height: 100%;
            flex: 1;
            transition: background 0.5s;
        }

        /* Relativity Visual */
        .event-horizon {
            height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }
        .black-hole {
            width: 40px;
            height: 40px;
            background: #000;
            border-radius: 50%;
            box-shadow: 0 0 20px #fff, 0 0 40px var(--accent), 0 0 60px var(--accent-glow);
            position: relative;
            z-index: 2;
        }
        .accretion-disk {
            position: absolute;
            width: 120%;
            height: 20px;
            background: linear-gradient(90deg, transparent, var(--accent), #fff, var(--accent), transparent);
            opacity: 0.6;
            filter: blur(4px);
            animation: rotateDisk 2s infinite linear;
        }
        @keyframes rotateDisk {
            from { transform: rotateX(70deg) rotateZ(0deg); }
            to { transform: rotateX(70deg) rotateZ(360deg); }
        }

        /* Cellular Automata Visual */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(20, 1fr);
            gap: 1px;
            background: rgba(255, 255, 255, 0.05);
            padding: 1px;
            border-radius: 4px;
        }
        .grid-cell {
            aspect-ratio: 1;
            background: #030303;
            border-radius: 1px;
        }
        .grid-cell.active {
            background: var(--accent);
            box-shadow: 0 0 5px var(--accent-glow);
        }

        .scanning-line {
            position: absolute;
            left: 0; right: 0; height: 2px;
            background: var(--accent);
            box-shadow: 0 0 15px var(--accent);
            z-index: 100;
            pointer-events: none;
            animation: scan 3s infinite linear;
        }
        @keyframes scan {
            0% { top: 0%; opacity: 0; }
            50% { opacity: 1; }
            100% { top: 100%; opacity: 0; }
        }

        .telemetry {
            position: fixed;
            font-family: monospace;
            font-size: 9px;
            color: var(--subtext);
            text-transform: uppercase;
            letter-spacing: 2px;
            pointer-events: none;
        }
        .tl { top: 30px; left: 30px; }
        .tr { top: 30px; right: 30px; }
        .bl { bottom: 30px; left: 30px; }
        .br { bottom: 30px; right: 30px; }

        canvas#bgCanvas {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1;
        }

        @keyframes diffuse {
            0% { transform: translate(0, 0) scale(1); opacity: 0.8; }
            100% { transform: translate(var(--dx), var(--dy)) scale(2); opacity: 0; }
        }
    </style>
</head>
<body>
    <canvas id="bgCanvas"></canvas>
    
    <div class="telemetry tl">PROB_MATRIX: {{ (Math.random()).toFixed(6) }}</div>
    <div class="telemetry tr">ENTROPY: {{ (Math.random() * 10).toFixed(2) }} J/K</div>
    <div class="telemetry bl">COORD: 31.23°N 121.47°E</div>
    <div class="telemetry br">SCANS: {{ scanCount }} | VER: 2.2.0</div>

    <div id="app">
        <div class="container">
            <div v-if="isObserving" class="scanning-line"></div>
            
            <div style="position: absolute; top: 20px; right: 30px; font-family: monospace; font-size: 8px; color: var(--subtext); text-align: right;">
                SYS_STATUS: {{ isObserving ? 'ACTIVE' : 'READY' }}<br>
                CPU_LOAD: {{ (Math.random()*10 + 2).toFixed(1) }}%
            </div>

            <h1>QUANTUM DESTINY</h1>
            <p class="subtitle">Predictive Reality Engine</p>
            
            <div class="input-group">
                <label>Subject Signature</label>
                <input v-model="name" placeholder="Enter identifier..." :disabled="isObserving" spellcheck="false">
            </div>
            
            <button @click="observe" :disabled="!name || isObserving">
                {{ isObserving ? 'Processing Reality...' : 'Initiate Analysis' }}
            </button>

            <div v-if="isObserving" style="margin-top: 30px;">
                <div style="font-family: monospace; font-size: 10px; color: var(--accent); text-align: left; line-height: 2;">
                    <div v-for="log in terminalLogs" :key="log">>> {{ log }}</div>
                </div>
            </div>

            <div v-if="fortune && !isObserving" class="result">
                <div class="theory-tag">{{ theoryName }}</div>
                <div class="fortune-text">{{ fortune }}</div>
                
                <!-- Visual Modules -->
                <div v-if="theoryName.includes('Genetic')" class="viz-box">
                    <div class="gene-pool">
                        <div v-for="i in 5" :key="i" class="gene-strand">
                            <div v-for="j in 20" :key="j" class="gene-segment" 
                                 :style="{ background: Math.random() > 0.7 ? 'var(--accent)' : 'rgba(255,255,255,0.1)' }">
                            </div>
                        </div>
                    </div>
                    <div style="font-family: monospace; font-size: 8px; color: var(--subtext); margin-top: 12px; display: flex; justify-content: space-between;">
                        <span>GEN_EVOLUTION: SUCCESS</span>
                        <span>FITNESS: 0.9984</span>
                    </div>
                </div>

                <div v-if="theoryName.includes('Chaos')" class="viz-box">
                    <svg width="100%" height="60" viewBox="0 0 200 60">
                        <path d="M 10 30 Q 50 10 100 30 T 190 30" fill="none" stroke="var(--accent)" stroke-width="0.5" opacity="0.5">
                            <animate attributeName="d" values="M 10 30 Q 50 10 100 30 T 190 30; M 10 30 Q 50 50 100 30 T 190 30; M 10 30 Q 50 10 100 30 T 190 30" dur="3s" repeatCount="indefinite" />
                        </path>
                        <circle cx="100" cy="30" r="2" fill="var(--accent)">
                            <animate attributeName="r" values="2;5;2" dur="2s" repeatCount="indefinite" />
                        </circle>
                    </svg>
                </div>

                <div v-if="theoryName.includes('Riemann')" class="viz-box">
                    <div style="height: 40px; display: flex; align-items: flex-end; gap: 2px;">
                        <div v-for="i in 40" :key="i" 
                             :style="{ height: (Math.abs(Math.sin(i * 0.2)) * 100) + '%', width: '4px', background: 'var(--accent)', opacity: Math.random() * 0.5 + 0.2 }">
                        </div>
                    </div>
                    <div style="font-family: monospace; font-size: 8px; color: var(--subtext); margin-top: 10px;">ZETA_ZERO_CROSSING: DETECTION_LOCKED</div>
                </div>

                <div v-if="theoryName.includes('Relativity')" class="viz-box">
                    <div class="event-horizon">
                        <div class="black-hole"></div>
                        <div class="accretion-disk"></div>
                    </div>
                    <div style="font-family: monospace; font-size: 8px; color: var(--subtext); margin-top: 10px; display: flex; justify-content: space-between;">
                        <span>GRAVITY_GRADIENT: 9.81g</span>
                        <span>Δt_DILATION: 0.00042s/yr</span>
                    </div>
                </div>

                <div v-if="theoryName.includes('Game Theory')" class="viz-box">
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                        <div v-for="i in 4" :key="i" 
                             class="strategy-cell"
                             :style="{ 
                                border: '1px solid rgba(0, 242, 255, 0.2)', 
                                padding: '10px', 
                                borderRadius: '8px',
                                background: (i === 1) ? 'rgba(0, 242, 255, 0.1)' : 'transparent',
                                position: 'relative'
                             }">
                            <div v-if="i === 1" style="position: absolute; top: -5px; right: -5px; width: 6px; height: 6px; background: var(--accent); border-radius: 50%; box-shadow: 0 0 10px var(--accent);"></div>
                            <div style="font-family: monospace; font-size: 9px; color: var(--accent); margin-bottom: 4px;">P{{i}}: {{ (Math.random() * 10).toFixed(0) }}</div>
                            <div style="height: 2px; background: rgba(255,255,255,0.05); width: 100%;">
                                <div :style="{ width: (Math.random() * 100) + '%', height: '100%', background: 'var(--accent)', opacity: 0.5 }"></div>
                            </div>
                        </div>
                    </div>
                    <div style="font-family: monospace; font-size: 8px; color: var(--subtext); margin-top: 12px; text-align: center;">EQUILIBRIUM_FOUND: COOPERATIVE_DOMINANCE</div>
                </div>

                <div v-if="theoryName.includes('Cellular')" class="viz-box">
                    <div class="grid-container">
                        <div v-for="i in 100" :key="i" class="grid-cell" :class="{ active: Math.random() > 0.8 }"></div>
                    </div>
                    <div style="font-family: monospace; font-size: 8px; color: var(--subtext); margin-top: 10px; display: flex; justify-content: space-between;">
                        <span>GEN_COUNT: 42</span>
                        <span>EMERGENCE: STABLE_OSCILLATOR</span>
                    </div>
                </div>

                <div v-if="theoryName.includes('String Theory')" class="viz-box">
                    <div style="height: 60px; display: flex; align-items: center; justify-content: center; position: relative;">
                        <svg width="100%" height="100%" viewBox="0 0 200 60">
                            <path v-for="i in 6" :key="i"
                                  :d="'M 20 ' + (10 + i*7) + ' Q 100 ' + (Math.random()*40 + 10) + ' 180 ' + (10 + i*7)"
                                  fill="none" 
                                  stroke="var(--accent)" 
                                  stroke-width="0.3" 
                                  :opacity="0.2 + (i*0.1)">
                                <animate attributeName="d" 
                                         :values="'M 20 ' + (10 + i*7) + ' Q 100 ' + (Math.random()*40 + 10) + ' 180 ' + (10 + i*7) + '; M 20 ' + (10 + i*7) + ' Q 100 ' + (Math.random()*40 + 10) + ' 180 ' + (10 + i*7) + '; M 20 ' + (10 + i*7) + ' Q 100 ' + (Math.random()*40 + 10) + ' 180 ' + (10 + i*7)"
                                         dur="2s" repeatCount="indefinite" />
                            </path>
                        </svg>
                        <div style="position: absolute; font-family: monospace; font-size: 7px; color: var(--accent); top: 5px; right: 10px; opacity: 0.6;">DIMENSIONS: 11D</div>
                    </div>
                    <div style="font-family: monospace; font-size: 8px; color: var(--subtext); margin-top: 5px; text-align: center;">CALABI-YAU_MANIFOLD: RESONATING</div>
                </div>

                <div v-if="theoryName.includes('Thermodynamics')" class="viz-box">
                    <div style="height: 60px; position: relative; overflow: hidden; background: rgba(255, 60, 0, 0.05); border-radius: 12px;">
                        <div v-for="i in 30" :key="i" 
                             class="entropy-particle"
                             :style="{ 
                                position: 'absolute',
                                left: Math.random() * 100 + '%',
                                top: Math.random() * 100 + '%',
                                width: '2px',
                                height: '2px',
                                background: Math.random() > 0.5 ? 'var(--secondary)' : 'var(--accent)',
                                borderRadius: '50%',
                                '--dx': (Math.random() * 60 - 30) + 'px',
                                '--dy': (Math.random() * 60 - 30) + 'px',
                                animation: `diffuse ${Math.random() * 2 + 1}s infinite linear`
                             }">
                        </div>
                        <div style="position: absolute; top: 10px; right: 15px; font-family: monospace; font-size: 10px; color: var(--secondary); opacity: 0.8;">
                            ENTROPY_FLUX: ACTIVE
                        </div>
                        <div style="position: absolute; bottom: 10px; left: 15px; font-family: monospace; font-size: 14px; color: var(--secondary); font-weight: 900; text-shadow: 0 0 10px var(--secondary);">
                            S: {{ (Math.random() * 0.5 + 0.1).toFixed(4) }}
                        </div>
                    </div>
                    <div style="font-family: monospace; font-size: 8px; color: var(--subtext); margin-top: 10px; display: flex; justify-content: space-between;">
                        <span>THERMAL_EQUILIBRIUM: REJECTED</span>
                        <span>ORDER_PARAMETER: 0.88</span>
                    </div>
                </div>

                <div v-if="theoryName.includes('Information Theory')" class="viz-box">
                    <div style="display: flex; flex-direction: column; gap: 4px;">
                        <div v-for="i in 4" :key="i" style="display: flex; gap: 4px;">
                            <div v-for="j in 20" :key="j" 
                                 :style="{ 
                                    flex: 1, 
                                    height: '8px', 
                                    background: Math.random() > 0.5 ? 'var(--accent)' : 'rgba(255,255,255,0.05)',
                                    borderRadius: '1px',
                                    opacity: Math.random() * 0.8 + 0.2
                                 }">
                            </div>
                        </div>
                    </div>
                    <div style="font-family: monospace; font-size: 8px; color: var(--subtext); margin-top: 10px; display: flex; justify-content: space-between;">
                        <span>SHANNON_ENTROPY: 0.94 bits/sym</span>
                        <span>SIGNAL_TO_NOISE: 42dB</span>
                    </div>
                </div>

                <div style="margin-top: 30px; font-size: 9px; color: var(--subtext); font-family: monospace; letter-spacing: 1px;">
                    TS: {{ scanTime }} | HASH: {{ Math.random().toString(36).substring(7).toUpperCase() }}
                </div>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('bgCanvas');
        const ctx = canvas.getContext('2d');
        let points = [];
        let animationId;

        function initCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', initCanvas);
        initCanvas();

        window.startVisuals = (mode) => {
            cancelAnimationFrame(animationId);
            points = [];
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;

            if (mode === 'genetic') {
                for(let i=0; i<100; i++) {
                    points.push({
                        x: Math.random() * canvas.width,
                        y: Math.random() * canvas.height,
                        s: Math.random() * 2,
                        v: Math.random() * 0.5 + 0.1,
                        a: Math.random() * Math.PI * 2
                    });
                }
            } else if (mode === 'chaos') {
                // Lorenz attractor sim simplified for bg
                let x = 0.1, y = 0, z = 0;
                const a = 10, b = 28, c = 8/3, dt = 0.01;
                for(let i=0; i<1000; i++) {
                    let dx = a * (y - x) * dt;
                    let dy = (x * (b - z) - y) * dt;
                    let dz = (x * y - c * z) * dt;
                    x += dx; y += dy; z += dz;
                    points.push({x: x * 20 + centerX, y: y * 20 + centerY});
                }
            } else if (mode === 'relativity') {
                for(let i=0; i<200; i++) {
                    const angle = Math.random() * Math.PI * 2;
                    const dist = Math.random() * 300 + 50;
                    points.push({
                        x: centerX + Math.cos(angle) * dist,
                        y: centerY + Math.sin(angle) * dist,
                        originX: centerX,
                        originY: centerY,
                        angle: angle,
                        dist: dist,
                        v: (1 / dist) * 10
                    });
                }
            } else if (mode === 'gametheory') {
                const rows = 10, cols = 10;
                const spacingX = canvas.width / (cols + 1);
                const spacingY = canvas.height / (rows + 1);
                for(let r=1; r<=rows; r++) {
                    for(let c=1; c<=cols; c++) {
                        points.push({
                            x: c * spacingX,
                            y: r * spacingY,
                            baseX: c * spacingX,
                            baseY: r * spacingY,
                            active: Math.random() > 0.8,
                            pulse: Math.random() * Math.PI * 2
                        });
                    }
                }
            } else if (mode === 'thermo') {
                for(let i=0; i<300; i++) {
                    points.push({
                        x: Math.random() * canvas.width,
                        y: Math.random() * canvas.height,
                        vx: (Math.random() - 0.5) * 2,
                        vy: (Math.random() - 0.5) * 2,
                        s: Math.random() * 2 + 1,
                        life: Math.random()
                    });
                }
            } else {
                for(let i=0; i<150; i++) {
                    points.push({
                        x: Math.random() * canvas.width,
                        y: Math.random() * canvas.height,
                        s: Math.random() * 1,
                        vx: (Math.random() - 0.5) * 0.2,
                        vy: (Math.random() - 0.5) * 0.2
                    });
                }
            }

            function animate() {
                ctx.fillStyle = 'rgba(3, 3, 3, 0.1)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                if (mode === 'genetic') {
                    points.forEach(p => {
                        p.x += Math.cos(p.a) * p.v;
                        p.y += Math.sin(p.a) * p.v;
                        if(p.x < 0 || p.x > canvas.width) p.a = Math.PI - p.a;
                        if(p.y < 0 || p.y > canvas.height) p.a = -p.a;
                        ctx.fillStyle = 'rgba(0, 242, 255, 0.2)';
                        ctx.beginPath();
                        ctx.arc(p.x, p.y, p.s, 0, Math.PI * 2);
                        ctx.fill();
                    });
                } else if (mode === 'chaos') {
                    ctx.strokeStyle = 'rgba(0, 242, 255, 0.1)';
                    ctx.beginPath();
                    ctx.moveTo(points[0].x, points[0].y);
                    for(let i=1; i<points.length; i++) {
                        ctx.lineTo(points[i].x, points[i].y);
                    }
                    ctx.stroke();
                } else if (mode === 'relativity') {
                    points.forEach(p => {
                        p.angle += p.v;
                        p.x = p.originX + Math.cos(p.angle) * p.dist;
                        p.y = p.originY + Math.sin(p.angle) * p.dist;
                        ctx.fillStyle = `rgba(0, 242, 255, ${Math.min(1, 20/p.dist)})`;
                        ctx.beginPath();
                        ctx.arc(p.x, p.y, 1, 0, Math.PI * 2);
                        ctx.fill();
                    });
                } else if (mode === 'gametheory') {
                    points.forEach((p, i) => {
                        p.pulse += 0.05;
                        const scale = 1 + Math.sin(p.pulse) * 0.3;
                        ctx.fillStyle = p.active ? `rgba(0, 242, 255, ${0.1 + Math.sin(p.pulse)*0.05})` : 'rgba(255, 255, 255, 0.02)';
                        ctx.beginPath();
                        ctx.arc(p.x, p.y, 2 * scale, 0, Math.PI * 2);
                        ctx.fill();

                        // Connect to neighbors
                        if (p.active) {
                            points.forEach((other, oi) => {
                                if (oi > i && other.active) {
                                    const dist = Math.hypot(p.x - other.x, p.y - other.y);
                                    if (dist < 200) {
                                        ctx.strokeStyle = `rgba(0, 242, 255, ${0.05 * (1 - dist/200)})`;
                                        ctx.lineWidth = 0.5;
                                        ctx.beginPath();
                                        ctx.moveTo(p.x, p.y);
                                        ctx.lineTo(other.x, other.y);
                                        ctx.stroke();
                                    }
                                }
                            });
                        }
                    });
                } else if (mode === 'cellular') {
                    points.forEach(p => {
                        if (p.active) {
                            ctx.fillStyle = 'rgba(0, 242, 255, 0.05)';
                            ctx.fillRect(p.x, p.y, 18, 18);
                        }
                    });
                } else if (mode === 'thermo') {
                    points.forEach(p => {
                        p.x += p.vx; p.y += p.vy;
                        p.life -= 0.01;
                        if(p.life <= 0 || p.x < 0 || p.x > canvas.width || p.y < 0 || p.y > canvas.height) {
                            p.x = Math.random() * canvas.width;
                            p.y = Math.random() * canvas.height;
                            p.life = 1;
                        }
                        ctx.fillStyle = `rgba(255, 0, 193, ${p.life * 0.3})`;
                        ctx.beginPath();
                        ctx.arc(p.x, p.y, p.s * (2 - p.life), 0, Math.PI * 2);
                        ctx.fill();
                    });
                } else {
                    points.forEach(p => {
                        p.x += p.vx; p.y += p.vy;
                        if(p.x < 0 || p.x > canvas.width) p.vx *= -1;
                        if(p.y < 0 || p.y > canvas.height) p.vy *= -1;
                        ctx.fillStyle = 'rgba(0, 242, 255, 0.15)';
                        ctx.beginPath();
                        ctx.arc(p.x, p.y, p.s, 0, Math.PI * 2);
                        ctx.fill();
                    });
                }
                animationId = requestAnimationFrame(animate);
            }
            animate();
        };
        window.startVisuals();

        const { createApp, ref } = Vue;
        createApp({
            setup() {
                const name = ref('');
                const fortune = ref('');
                const theoryName = ref('');
                const scanTime = ref('');
                const isObserving = ref(false);
                const terminalLogs = ref([]);
                const scanCount = ref(parseInt(localStorage.getItem('destiny_scans') || '0'));

                const theories = [
                    {
                        name: "遗传算法：演化适性 (Genetic Algorithm & Evolutionary Fate)",
                        mode: 'genetic',
                        generate: (n) => {
                            const outcomes = [
                                "基因池演化显示，你当前的行为模式正在快速收敛于一个『全局最优解』。只要保持目前的变异率（创新性），你将在三个周期内迎来生命质变。",
                                "由于环境压力的增加，你的『适性函数』正在重塑。建议在未来两周内增加社交基因的表达强度，以在多维博弈中占据生存优势。",
                                "探测到一股强大的『定向选择』力量。你过去积累的非核心技能正在发生交叉重组，预示着一个全新的职业领域即将为你开启。"
                            ];
                            return outcomes[n.length % outcomes.length];
                        }
                    },
                    {
                        name: "黎曼猜想：素数分布 (Riemann Zeta Hypothesis)",
                        mode: 'riemann',
                        generate: (n) => "观测到你的命运分布正紧密围绕『临界线』展开。这意味着你的生活虽然充满波动，但其底层规律极其稳健，所有看似随机的事件都在为最终的秩序积蓄能量。"
                    },
                    {
                        name: "混沌理论：蝴蝶效应 (Chaos Theory: Butterfly Effect)",
                        mode: 'chaos',
                        generate: (n) => "对初始条件的敏感依赖表明，改变你处理琐事的方式将彻底重写你下个月的财务曲线。一次微小的蝴蝶振翅，正引导你走向宏大的奇异吸引子。"
                    },
                    {
                        name: "广义相对论：时间膨胀 (General Relativity & Time Dilation)",
                        mode: 'relativity',
                        generate: (n) => "时空曲率检测到你正处于一个高能质点附近，这导致了明显的时间膨胀效应。你感知到的『停滞』实际上是外界正在加速演化的错觉。在你的视界边缘，巨大的机遇正被引力锁定。"
                    },
                    {
                        name: "量子隧穿：势垒跃迁 (Quantum Tunneling)",
                        mode: 'tunneling',
                        generate: (n) => "波函数分析显示，你正面临一个传统逻辑上无法逾越的障碍。但由于量子隧穿效应，你已经获得了直接穿透势垒的概率。本月将有不合常理的突破。"
                    },
                    {
                        name: "博弈论：纳什均衡 (Game Theory & Nash Equilibrium)",
                        mode: 'gametheory',
                        generate: (n) => {
                            const outcomes = [
                                "社交场域的多维博弈显示，你正处于一个非对称信息的优势地位。采取『合作博弈』策略将使你的整体收益（人际关系与机会）达到帕累托最优。",
                                "博弈矩阵分析表明，你过去一段时间的『让步』正在形成一种长期的威慑均衡。对方正在重新评估你的底线，预计下周将达成对你更有利的协议。",
                                "在当前的社会博弈中，你正处于『零和博弈』的边缘。切换到『重复博弈』视角，以长期信誉换取短期资源，是当下的最优策略（Nash Equilibrium）。"
                            ];
                            return outcomes[n.length % outcomes.length];
                        }
                    },
                    {
                        name: "元胞自动机：生命涌现 (Cellular Automata & Emergent Complexity)",
                        mode: 'cellular',
                        generate: (n) => "你的生命轨迹正处于一个从简单规则向高度复杂性转化的临界点。就像元胞自动机中的『滑翔机』，一个微小的习惯正在你的生活矩阵中持续移动，并最终引发连锁反应，创造出预料之外的宏大结构。"
                    },
                    {
                        name: "热力学：负熵流与稳态 (Thermodynamics: Negative Entropy & Steady State)",
                        mode: 'thermo',
                        generate: (n) => "热力学第二定律显示，你的系统（生活）正处于一个暂时的高熵状态，导致信息流模糊。然而，探测到一股强大的『负熵流』（可能来自外部环境的注入或内在意志的觉醒）正在逆转这一趋势。通过耗散结构的建立，你正从混沌中演化出全新的有序稳态。"
                    },
                    {
                        name: "信息论：香农熵与信号重建 (Information Theory & Signal Reconstruction)",
                        mode: 'information',
                        generate: (n) => "在当前充满噪声的生活背景中，你的核心意图（Signal）正经历香农极限的考验。观测显示，一个高保真的采样周期即将到来，你之前被误解或丢失的努力将被完美重建，实现信息的最大化增益。"
                    },
                    {
                        name: "弦理论：高维共振 (String Theory & Multidimensional Resonance)",
                        mode: 'string',
                        generate: (n) => "你的命运并非单一的线，而是跨越11维空间的闭合弦。目前的低频波动只是在为一次跨维度的共振做准备。当你的基频与外部场匹配时，你将在多个生活维度（财富、情感、精神）同时观察到跃迁现象。"
                    }
                ];

                const observe = () => {
                    isObserving.value = true;
                    terminalLogs.value = [];
                    const logs = [
                        "INITIALIZING NEURAL BRIDGE...",
                        "CALIBRATING PROBABILITY FIELD...",
                        "SEQUENCING TEMPORAL GENES...",
                        "MEASURING ENTROPY GRADIENT...",
                        "RESOLVING LORENZ ATTRACTOR...",
                        "FINALIZING REALITY COLLAPSE..."
                    ];
                    let logIdx = 0;
                    const logInterval = setInterval(() => {
                        if (logIdx < logs.length) terminalLogs.value.push(logs[logIdx++]);
                        else clearInterval(logInterval);
                    }, 400);

                    setTimeout(() => {
                        const theory = theories[Math.floor(Math.random() * theories.length)];
                        theoryName.value = theory.name;
                        fortune.value = theory.generate(name.value);
                        scanTime.value = new Date().toLocaleTimeString();
                        scanCount.value++;
                        localStorage.setItem('destiny_scans', scanCount.value);
                        window.startVisuals(theory.mode);
                        isObserving.value = false;
                    }, 2800);
                };

                return { name, fortune, theoryName, scanTime, isObserving, observe, terminalLogs, scanCount };
            }
        }).mount('#app');
    </script>
</body>
</html>
